<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meal Planner + Digital Cookbook</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .instructions-text {
            white-space: pre-wrap;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const MealPlannerApp = () => {
          const [meals, setMeals] = useState([]);
          const [recipes, setRecipes] = useState([
            {
              id: 1,
              name: "Chicken Stir Fry",
              url: "",
              instructions: "1. Heat oil in a large pan or wok over high heat.\n2. Add chicken and cook until golden brown, about 5-7 minutes.\n3. Add vegetables and stir fry for 3-4 minutes.\n4. Add soy sauce and cook for another 2 minutes.\n5. Serve hot over rice.",
              ingredients: [
                { name: "Chicken breast", amount: 500, unit: "g" },
                { name: "Mixed vegetables", amount: 300, unit: "g" },
                { name: "Soy sauce", amount: 2, unit: "tbsp" },
                { name: "Rice", amount: 200, unit: "g" },
                { name: "Vegetable oil", amount: 2, unit: "tbsp" }
              ],
              servings: 4,
              calories: 450,
              protein: 35,
              carbs: 48,
              fat: 12,
              prepTime: "10 min",
              cookTime: "15 min"
            },
            {
              id: 2,
              name: "Spaghetti Bolognese",
              url: "",
              instructions: "1. Cook spaghetti according to package directions.\n2. In a large pan, brown the ground beef over medium-high heat.\n3. Add diced onion and garlic, cook until softened.\n4. Pour in tomato sauce and simmer for 15 minutes.\n5. Season with salt, pepper, and Italian herbs.\n6. Serve sauce over cooked spaghetti.",
              ingredients: [
                { name: "Ground beef", amount: 400, unit: "g" },
                { name: "Spaghetti", amount: 400, unit: "g" },
                { name: "Tomato sauce", amount: 400, unit: "g" },
                { name: "Onion", amount: 1, unit: "piece" },
                { name: "Garlic", amount: 2, unit: "cloves" }
              ],
              servings: 4,
              calories: 520,
              protein: 28,
              carbs: 65,
              fat: 16,
              prepTime: "10 min",
              cookTime: "25 min"
            },
            {
              id: 3,
              name: "Caesar Salad",
              url: "",
              instructions: "1. Grill or pan-fry chicken breast until cooked through.\n2. Let chicken rest, then slice into strips.\n3. Wash and chop romaine lettuce.\n4. In a large bowl, toss lettuce with Caesar dressing.\n5. Add croutons and grated Parmesan cheese.\n6. Top with sliced chicken and serve immediately.",
              ingredients: [
                { name: "Romaine lettuce", amount: 2, unit: "heads" },
                { name: "Caesar dressing", amount: 100, unit: "ml" },
                { name: "Parmesan cheese", amount: 50, unit: "g" },
                { name: "Croutons", amount: 100, unit: "g" },
                { name: "Chicken breast", amount: 300, unit: "g" }
              ],
              servings: 2,
              calories: 380,
              protein: 32,
              carbs: 18,
              fat: 22,
              prepTime: "15 min",
              cookTime: "10 min"
            },
            {
              id: 4,
              name: "Vegetable Curry",
              url: "",
              instructions: "1. Cook rice according to package directions.\n2. Heat oil in a large pot over medium heat.\n3. Add curry paste and cook for 1 minute until fragrant.\n4. Add mixed vegetables and stir to coat.\n5. Pour in coconut milk and bring to a simmer.\n6. Cook for 15-20 minutes until vegetables are tender.\n7. Serve over rice.",
              ingredients: [
                { name: "Mixed vegetables", amount: 500, unit: "g" },
                { name: "Coconut milk", amount: 400, unit: "ml" },
                { name: "Curry paste", amount: 3, unit: "tbsp" },
                { name: "Rice", amount: 300, unit: "g" }
              ],
              servings: 4,
              calories: 420,
              protein: 8,
              carbs: 58,
              fat: 18,
              prepTime: "10 min",
              cookTime: "20 min"
            },
            {
              id: 5,
              name: "Scrambled Eggs & Toast",
              url: "",
              instructions: "1. Crack eggs into a bowl and whisk with milk.\n2. Heat butter in a non-stick pan over medium-low heat.\n3. Pour in egg mixture and let sit for 20 seconds.\n4. Gently stir with a spatula, creating large curds.\n5. Remove from heat when still slightly wet.\n6. Toast bread and butter it.\n7. Serve eggs on toast.",
              ingredients: [
                { name: "Eggs", amount: 6, unit: "piece" },
                { name: "Bread", amount: 4, unit: "slices" },
                { name: "Butter", amount: 20, unit: "g" },
                { name: "Milk", amount: 50, unit: "ml" }
              ],
              servings: 2,
              calories: 380,
              protein: 24,
              carbs: 32,
              fat: 18,
              prepTime: "5 min",
              cookTime: "10 min"
            }
          ]);
          
          const [customRecipe, setCustomRecipe] = useState({
            name: '',
            url: '',
            instructions: '',
            ingredients: [{ name: '', amount: '', unit: 'g' }],
            servings: 1,
            calories: 0,
            protein: 0,
            carbs: 0,
            fat: 0,
            prepTime: '',
            cookTime: ''
          });
          
          const [showAddRecipe, setShowAddRecipe] = useState(false);
          const [selectedRecipe, setSelectedRecipe] = useState(null);
          const [activeTab, setActiveTab] = useState('planner');
          const [pantryItems, setPantryItems] = useState([]);
          const [newPantryItem, setNewPantryItem] = useState('');
          
          const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
          const mealTypes = ['Breakfast', 'Lunch', 'Dinner', 'Snack'];

          useEffect(() => {
            const savedMeals = localStorage.getItem('mealPlans');
            const savedRecipes = localStorage.getItem('customRecipes');
            const savedPantry = localStorage.getItem('pantryItems');
            if (savedMeals) setMeals(JSON.parse(savedMeals));
            if (savedRecipes) setRecipes(JSON.parse(savedRecipes));
            if (savedPantry) setPantryItems(JSON.parse(savedPantry));
          }, []);

          const saveMeals = (newMeals) => {
            setMeals(newMeals);
            localStorage.setItem('mealPlans', JSON.stringify(newMeals));
          };

          const saveRecipes = (newRecipes) => {
            setRecipes(newRecipes);
            localStorage.setItem('customRecipes', JSON.stringify(newRecipes));
          };

          const savePantry = (newPantry) => {
            setPantryItems(newPantry);
            localStorage.setItem('pantryItems', JSON.stringify(newPantry));
          };

          const addMeal = (day, mealType, recipe) => {
            saveMeals([...meals, { id: Date.now(), day, mealType, recipe }]);
          };

          const removeMeal = (id) => {
            saveMeals(meals.filter(meal => meal.id !== id));
          };

          const addIngredientToCustomRecipe = () => {
            setCustomRecipe({
              ...customRecipe,
              ingredients: [...customRecipe.ingredients, { name: '', amount: '', unit: 'g' }]
            });
          };

          const updateCustomRecipeIngredient = (index, field, value) => {
            const newIngredients = [...customRecipe.ingredients];
            newIngredients[index][field] = value;
            setCustomRecipe({ ...customRecipe, ingredients: newIngredients });
          };

          const removeIngredientFromCustomRecipe = (index) => {
            setCustomRecipe({ ...customRecipe, ingredients: customRecipe.ingredients.filter((_, i) => i !== index) });
          };

          const saveCustomRecipe = () => {
            if (!customRecipe.name || customRecipe.ingredients.some(i => !i.name || !i.amount)) {
              alert('Please fill in recipe name and all ingredients');
              return;
            }
            
            const newRecipe = {
              id: Date.now(),
              ...customRecipe,
              ingredients: customRecipe.ingredients.map(ing => ({
                ...ing,
                amount: parseFloat(ing.amount)
              })),
              servings: parseInt(customRecipe.servings) || 1,
              calories: parseInt(customRecipe.calories) || 0,
              protein: parseInt(customRecipe.protein) || 0,
              carbs: parseInt(customRecipe.carbs) || 0,
              fat: parseInt(customRecipe.fat) || 0
            };
            
            saveRecipes([...recipes, newRecipe]);
            setCustomRecipe({
              name: '',
              url: '',
              instructions: '',
              ingredients: [{ name: '', amount: '', unit: 'g' }],
              servings: 1,
              calories: 0,
              protein: 0,
              carbs: 0,
              fat: 0,
              prepTime: '',
              cookTime: ''
            });
            setShowAddRecipe(false);
          };

          const deleteRecipe = (recipeId) => {
            if (confirm('Are you sure you want to delete this recipe?')) {
              saveRecipes(recipes.filter(r => r.id !== recipeId));
              if (selectedRecipe?.id === recipeId) {
                setSelectedRecipe(null);
              }
            }
          };

          const generateGroceryList = () => {
            const groceryMap = {};
            
            meals.forEach(meal => {
              meal.recipe.ingredients.forEach(ingredient => {
                if (groceryMap[ingredient.name]) {
                  groceryMap[ingredient.name].amount += ingredient.amount;
                } else {
                  groceryMap[ingredient.name] = {
                    amount: ingredient.amount,
                    unit: ingredient.unit
                  };
                }
              });
            });
            
            return Object.entries(groceryMap).map(([name, data]) => ({ name, ...data }));
          };

          const calculateNutrition = () => {
            const totals = { calories: 0, protein: 0, carbs: 0, fat: 0 };
            meals.forEach(meal => {
              totals.calories += meal.recipe.calories;
              totals.protein += meal.recipe.protein;
              totals.carbs += meal.recipe.carbs;
              totals.fat += meal.recipe.fat;
            });
            return totals;
          };

          const findMatchingRecipes = () => {
            const pantrySet = new Set(pantryItems.map(item => item.toLowerCase().trim()));
            
            return recipes.map(recipe => {
              const recipeIngredients = recipe.ingredients.map(ing => ing.name.toLowerCase());
              const matchingIngredients = recipeIngredients.filter(ing => pantrySet.has(ing));
              const missingIngredients = recipe.ingredients.filter(
                ing => !pantrySet.has(ing.name.toLowerCase())
              );
              
              const matchPercentage = (matchingIngredients.length / recipeIngredients.length) * 100;
              
              return {
                recipe,
                matchPercentage,
                matchingCount: matchingIngredients.length,
                missingIngredients,
                missingCount: missingIngredients.length
              };
            })
            .filter(result => result.matchPercentage > 0)
            .sort((a, b) => {
              if (a.missingCount !== b.missingCount) {
                return a.missingCount - b.missingCount;
              }
              return b.matchPercentage - a.matchPercentage;
            });
          };

          const addPantryItem = () => {
            if (newPantryItem.trim()) {
              savePantry([...pantryItems, newPantryItem.trim()]);
              setNewPantryItem('');
            }
          };

          const removePantryItem = (index) => {
            savePantry(pantryItems.filter((_, i) => i !== index));
          };

          const exportData = () => {
            const data = { meals, recipes, pantryItems };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'meal-planner-data.json';
            a.click();
          };

          const importData = (event) => {
            const file = event.target.files[0];
            if (file) {
              const reader = new FileReader();
              reader.onload = (e) => {
                try {
                  const data = JSON.parse(e.target.result);
                  if (data.meals) saveMeals(data.meals);
                  if (data.recipes) saveRecipes(data.recipes);
                  if (data.pantryItems) savePantry(data.pantryItems);
                  alert('Data imported successfully!');
                } catch (error) {
                  alert('Error importing data. Please check the file format.');
                }
              };
              reader.readAsText(file);
            }
          };

          const groceryList = generateGroceryList();
          const nutrition = calculateNutrition();
          const matchingRecipes = useMemo(() => findMatchingRecipes(), [pantryItems, recipes]);

          return (
            <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-4">
              <div className="max-w-7xl mx-auto">
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                  <div className="flex justify-between items-start">
                    <div>
                      <h1 className="text-4xl font-bold text-gray-800 mb-2">üçΩÔ∏è Meal Planner + Digital Cookbook</h1>
                      <p className="text-gray-600">Plan your week and organize your favorite recipes</p>
                    </div>
                    <div className="text-right">
                      <div className="text-xs text-gray-500 bg-gray-100 px-3 py-1 rounded-full">
                        v1.0.0
                      </div>
                    </div>
                  </div>
                  
                  <div className="flex gap-2 mt-4">
                    <button onClick={exportData} className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                      ‚Üì Export Data
                    </button>
                    <label className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition cursor-pointer">
                      ‚Üë Import Data
                      <input type="file" accept=".json" onChange={importData} className="hidden" />
                    </label>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg mb-6">
                  <div className="flex flex-wrap border-b">
                    {[
                      { key: 'planner', label: 'üìÖ Planner' },
                      { key: 'cookbook', label: 'üìñ Cookbook' },
                      { key: 'grocery', label: 'üõí Grocery' },
                      { key: 'pantry', label: 'üí° Smart Match' },
                      { key: 'nutrition', label: 'üìä Nutrition' }
                    ].map(({ key, label }) => (
                      <button
                        key={key}
                        onClick={() => setActiveTab(key)}
                        className={`flex-1 px-4 py-4 font-semibold transition min-w-[120px] ${
                          activeTab === key ? 'bg-blue-500 text-white' : 'text-gray-600 hover:bg-gray-100'
                        }`}
                      >
                        {label}
                      </button>
                    ))}
                  </div>
                </div>

                {activeTab === 'planner' && (
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Weekly Meal Plan</h2>
                    <div className="overflow-x-auto">
                      <table className="w-full border-collapse">
                        <thead>
                          <tr>
                            <th className="border p-3 bg-gray-100">Meal</th>
                            {daysOfWeek.map(day => (
                              <th key={day} className="border p-3 bg-gray-100">{day}</th>
                            ))}
                          </tr>
                        </thead>
                        <tbody>
                          {mealTypes.map(mealType => (
                            <tr key={mealType}>
                              <td className="border p-3 font-semibold bg-gray-50">{mealType}</td>
                              {daysOfWeek.map(day => {
                                const meal = meals.find(m => m.day === day && m.mealType === mealType);
                                return (
                                  <td key={`${day}-${mealType}`} className="border p-3">
                                    {meal ? (
                                      <div className="bg-blue-100 p-2 rounded relative group">
                                        <div className="font-medium text-sm">{meal.recipe.name}</div>
                                        <div className="text-xs text-gray-600">{meal.recipe.calories} cal</div>
                                        <button
                                          onClick={() => removeMeal(meal.id)}
                                          className="absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition text-red-500 font-bold text-lg"
                                        >
                                          √ó
                                        </button>
                                      </div>
                                    ) : (
                                      <select
                                        onChange={(e) => {
                                          const recipe = recipes.find(r => r.id === parseInt(e.target.value));
                                          if (recipe) addMeal(day, mealType, recipe);
                                          e.target.value = '';
                                        }}
                                        className="w-full p-2 border rounded text-sm"
                                        defaultValue=""
                                      >
                                        <option value="">+ Add meal</option>
                                        {recipes.map(recipe => (
                                          <option key={recipe.id} value={recipe.id}>{recipe.name}</option>
                                        ))}
                                      </select>
                                    )}
                                  </td>
                                );
                              })}
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </div>
                )}

                {activeTab === 'cookbook' && (
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <div className="flex justify-between items-center mb-4">
                      <h2 className="text-2xl font-bold text-gray-800">Digital Cookbook</h2>
                      <button
                        onClick={() => {
                          setShowAddRecipe(!showAddRecipe);
                          setSelectedRecipe(null);
                        }}
                        className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition"
                      >
                        + Add Recipe
                      </button>
                    </div>

                    {showAddRecipe && (
                      <div className="mb-6 p-4 bg-blue-50 rounded-lg">
                        <h3 className="font-bold text-lg mb-3">Create New Recipe</h3>
                        
                        <input
                          type="text"
                          placeholder="Recipe name *"
                          value={customRecipe.name}
                          onChange={(e) => setCustomRecipe({ ...customRecipe, name: e.target.value })}
                          className="w-full p-2 border rounded mb-3"
                        />

                        <input
                          type="url"
                          placeholder="Recipe URL (optional - link to your Excel or website)"
                          value={customRecipe.url}
                          onChange={(e) => setCustomRecipe({ ...customRecipe, url: e.target.value })}
                          className="w-full p-2 border rounded mb-3"
                        />

                        <div className="grid grid-cols-2 gap-3 mb-3">
                          <div>
                            <label className="block text-sm font-semibold mb-1">Servings</label>
                            <input type="number" placeholder="e.g., 4" value={customRecipe.servings} onChange={(e) => setCustomRecipe({ ...customRecipe, servings: e.target.value })} className="w-full p-2 border rounded" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-1">Prep Time</label>
                            <input type="text" placeholder="e.g., 10 min" value={customRecipe.prepTime} onChange={(e) => setCustomRecipe({ ...customRecipe, prepTime: e.target.value })} className="w-full p-2 border rounded" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-1">Cook Time</label>
                            <input type="text" placeholder="e.g., 20 min" value={customRecipe.cookTime} onChange={(e) => setCustomRecipe({ ...customRecipe, cookTime: e.target.value })} className="w-full p-2 border rounded" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-1">Calories (optional)</label>
                            <input type="number" placeholder="e.g., 450" value={customRecipe.calories} onChange={(e) => setCustomRecipe({ ...customRecipe, calories: e.target.value })} className="w-full p-2 border rounded" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-1">Protein (g, optional)</label>
                            <input type="number" placeholder="e.g., 35" value={customRecipe.protein} onChange={(e) => setCustomRecipe({ ...customRecipe, protein: e.target.value })} className="w-full p-2 border rounded" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-1">Carbs (g, optional)</label>
                            <input type="number" placeholder="e.g., 48" value={customRecipe.carbs} onChange={(e) => setCustomRecipe({ ...customRecipe, carbs: e.target.value })} className="w-full p-2 border rounded" />
                          </div>
                          <div>
                            <label className="block text-sm font-semibold mb-1">Fat (g, optional)</label>
                            <input type="number" placeholder="e.g., 12" value={customRecipe.fat} onChange={(e) => setCustomRecipe({ ...customRecipe, fat: e.target.value })} className="w-full p-2 border rounded" />
                          </div>
                        </div>

                        <div className="mb-3">
                          <label className="font-semibold block mb-2">Ingredients: *</label>
                          {customRecipe.ingredients.map((ingredient, index) => (
                            <div key={index} className="flex gap-2 mb-2">
                              <input type="text" placeholder="Ingredient name" value={ingredient.name} onChange={(e) => updateCustomRecipeIngredient(index, 'name', e.target.value)} className="flex-1 p-2 border rounded" />
                              <input type="number" placeholder="Amount" value={ingredient.amount} onChange={(e) => updateCustomRecipeIngredient(index, 'amount', e.target.value)} className="w-24 p-2 border rounded" />
                              <select value={ingredient.unit} onChange={(e) => updateCustomRecipeIngredient(index, 'unit', e.target.value)} className="w-24 p-2 border rounded">
                                <option value="g">g</option>
                                <option value="ml">ml</option>
                                <option value="piece">piece</option>
                                <option value="tbsp">tbsp</option>
                                <option value="tsp">tsp</option>
                                <option value="cup">cup</option>
                                <option value="oz">oz</option>
                                <option value="lb">lb</option>
                              </select>
                              <button onClick={() => removeIngredientFromCustomRecipe(index)} className="px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600">√ó</button>
                            </div>
                          ))}
                          <button onClick={addIngredientToCustomRecipe} className="mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">+ Add Ingredient</button>
                        </div>

                        <div className="mb-3">
                          <label className="font-semibold block mb-2">Cooking Instructions:</label>
                          <textarea
                            placeholder="Enter step-by-step instructions (one step per line)"
                            value={customRecipe.instructions}
                            onChange={(e) => setCustomRecipe({ ...customRecipe, instructions: e.target.value })}
                            className="w-full p-3 border rounded min-h-[150px]"
                          />
                        </div>

                        <div className="flex gap-2">
                          <button onClick={saveCustomRecipe} className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">üíæ Save Recipe</button>
                          <button onClick={() => setShowAddRecipe(false)} className="px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400">Cancel</button>
                        </div>
                      </div>
                    )}

                    {selectedRecipe ? (
                      <div className="border rounded-lg p-6 bg-white">
                        <div className="flex justify-between items-start mb-4">
                          <div>
                            <h3 className="text-3xl font-bold mb-2">{selectedRecipe.name}</h3>
                            {selectedRecipe.url && (
                              <a href={selectedRecipe.url} target="_blank" rel="noopener noreferrer" className="text-blue-600 hover:underline text-sm">
                                üîó View Original Recipe
                              </a>
                            )}
                          </div>
                          <button
                            onClick={() => setSelectedRecipe(null)}
                            className="text-gray-500 hover:text-gray-700 text-2xl"
                          >
                            √ó
                          </button>
                        </div>

                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 text-center">
                          {selectedRecipe.servings && (
                            <div className="bg-gray-50 p-3 rounded">
                              <div className="text-2xl font-bold text-gray-700">{selectedRecipe.servings}</div>
                              <div className="text-sm text-gray-600">Servings</div>
                            </div>
                          )}
                          {selectedRecipe.prepTime && (
                            <div className="bg-gray-50 p-3 rounded">
                              <div className="text-lg font-bold text-gray-700">{selectedRecipe.prepTime}</div>
                              <div className="text-sm text-gray-600">Prep Time</div>
                            </div>
                          )}
                          {selectedRecipe.cookTime && (
                            <div className="bg-gray-50 p-3 rounded">
                              <div className="text-lg font-bold text-gray-700">{selectedRecipe.cookTime}</div>
                              <div className="text-sm text-gray-600">Cook Time</div>
                            </div>
                          )}
                          {selectedRecipe.calories > 0 && (
                            <div className="bg-blue-50 p-3 rounded">
                              <div className="text-2xl font-bold text-blue-700">{selectedRecipe.calories}</div>
                              <div className="text-sm text-gray-600">Calories</div>
                            </div>
                          )}
                        </div>

                        <div className="mb-6">
                          <h4 className="font-bold text-xl mb-3">Ingredients</h4>
                          <ul className="space-y-2">
                            {selectedRecipe.ingredients.map((ing, index) => (
                              <li key={index} className="flex items-start">
                                <span className="text-blue-500 mr-2">‚ñ™</span>
                                <span>{ing.amount} {ing.unit} {ing.name}</span>
                              </li>
                            ))}
                          </ul>
                        </div>

                        {selectedRecipe.instructions && (
                          <div className="mb-6">
                            <h4 className="font-bold text-xl mb-3">Instructions</h4>
                            <div className="bg-gray-50 p-4 rounded instructions-text">
                              {selectedRecipe.instructions}
                            </div>
                          </div>
                        )}

                        {(selectedRecipe.protein > 0 || selectedRecipe.carbs > 0 || selectedRecipe.fat > 0) && (
                          <div>
                            <h4 className="font-bold text-xl mb-3">Nutrition Info</h4>
                            <div className="flex gap-3">
                              {selectedRecipe.protein > 0 && <span className="bg-green-100 px-3 py-1 rounded">Protein: {selectedRecipe.protein}g</span>}
                              {selectedRecipe.carbs > 0 && <span className="bg-yellow-100 px-3 py-1 rounded">Carbs: {selectedRecipe.carbs}g</span>}
                              {selectedRecipe.fat > 0 && <span className="bg-red-100 px-3 py-1 rounded">Fat: {selectedRecipe.fat}g</span>}
                            </div>
                          </div>
                        )}

                        <div className="mt-6 pt-4 border-t">
                          <button
                            onClick={() => deleteRecipe(selectedRecipe.id)}
                            className="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"
                          >
                            üóëÔ∏è Delete Recipe
                          </button>
                        </div>
                      </div>
                    ) : (
                      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        {recipes.map(recipe => (
                          <div
                            key={recipe.id}
                            onClick={() => setSelectedRecipe(recipe)}
                            className="border rounded-lg p-4 hover:shadow-lg transition cursor-pointer"
                          >
                            <h3 className="font-bold text-lg mb-2">{recipe.name}</h3>
                            {recipe.url && (
                              <div className="text-xs text-blue-600 mb-2 truncate">üîó Has link</div>
                            )}
                            <div className="text-sm text-gray-600 mb-2">
                              {recipe.servings && `${recipe.servings} servings`}
                              {recipe.prepTime && ` ‚Ä¢ ${recipe.prepTime}`}
                              {recipe.cookTime && ` ‚Ä¢ ${recipe.cookTime}`}
                            </div>
                            <div className="text-sm mb-3">
                              {recipe.calories > 0 && <span className="inline-block bg-blue-100 px-2 py-1 rounded mr-2 text-xs">{recipe.calories} cal</span>}
                              {recipe.protein > 0 && <span className="inline-block bg-green-100 px-2 py-1 rounded mr-2 text-xs">P: {recipe.protein}g</span>}
                              {recipe.carbs > 0 && <span className="inline-block bg-yellow-100 px-2 py-1 rounded mr-2 text-xs">C: {recipe.carbs}g</span>}
                              {recipe.fat > 0 && <span className="inline-block bg-red-100 px-2 py-1 rounded text-xs">F: {recipe.fat}g</span>}
                            </div>
                            <div className="text-xs text-gray-500">
                              {recipe.ingredients.length} ingredients
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}

                {activeTab === 'grocery' && (
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Grocery List</h2>
                    
                    {groceryList.length === 0 ? (
                      <p className="text-gray-500 text-center py-8">No meals planned yet. Add meals to generate your grocery list!</p>
                    ) : (
                      <div className="space-y-2">
                        {groceryList.map((item, index) => (
                          <div key={index} className="border rounded-lg p-4 flex justify-between items-center">
                            <div>
                              <span className="font-semibold text-lg">{item.name}</span>
                              <span className="text-gray-600 ml-3">{item.amount} {item.unit}</span>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}

                {activeTab === 'pantry' && (
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Smart Recipe Matcher</h2>
                    
                    <div className="mb-6 p-4 bg-blue-50 rounded-lg">
                      <h3 className="font-bold mb-3">What do you have at home?</h3>
                      <div className="flex gap-2 mb-3">
                        <input
                          type="text"
                          placeholder="Enter ingredient (e.g., Chicken breast)"
                          value={newPantryItem}
                          onChange={(e) => setNewPantryItem(e.target.value)}
                          onKeyPress={(e) => e.key === 'Enter' && addPantryItem()}
                          className="flex-1 p-2 border rounded"
                        />
                        <button
                          onClick={addPantryItem}
                          className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                        >
                          + Add
                        </button>
                      </div>
                      
                      <div className="flex flex-wrap gap-2">
                        {pantryItems.map((item, index) => (
                          <div key={index} className="flex items-center gap-2 px-3 py-1 bg-white border rounded-full">
                            <span>{item}</span>
                            <button
                              onClick={() => removePantryItem(index)}
                              className="text-red-500 hover:text-red-700 font-bold"
                            >
                              √ó
                            </button>
                          </div>
                        ))}
                      </div>
                    </div>
                    
                    <div>
                      <h3 className="font-bold text-lg mb-3">
                        Recipe Suggestions ({matchingRecipes.length} found)
                      </h3>
                      
                      {pantryItems.length === 0 ? (
                        <p className="text-gray-500 text-center py-8">Add ingredients above to find matching recipes!</p>
                      ) : matchingRecipes.length === 0 ? (
                        <p className="text-gray-500 text-center py-8">No matching recipes found. Try adding more ingredients!</p>
                      ) : (
                        <div className="space-y-4">
                          {matchingRecipes.map(({ recipe, matchPercentage, matchingCount, missingIngredients, missingCount }) => (
                            <div key={recipe.id} className="border rounded-lg p-4 hover:shadow-lg transition">
                              <div className="flex justify-between items-start mb-3">
                                <div>
                                  <h4 className="font-bold text-lg">{recipe.name}</h4>
                                  <div className="text-sm text-gray-600">
                                    {matchingCount}/{recipe.ingredients.length} ingredients you have
                                  </div>
                                </div>
                                <div className="text-right">
                                  <div className="text-2xl font-bold text-green-600">
                                    {Math.round(matchPercentage)}%
                                  </div>
                                  <div className="text-xs text-gray-500">match</div>
                                </div>
                              </div>
                              
                              <div className="w-full bg-gray-200 rounded-full h-2 mb-3">
                                <div className="bg-green-500 h-2 rounded-full" style={{ width: `${matchPercentage}%` }}></div>
                              </div>
                              
                              {missingCount > 0 && (
                                <div className="bg-yellow-50 p-3 rounded">
                                  <div className="font-semibold text-sm mb-2">
                                    Need to buy ({missingCount} item{missingCount > 1 ? 's' : ''}):
                                  </div>
                                  <div className="flex flex-wrap gap-2">
                                    {missingIngredients.map((ing, index) => (
                                      <span key={index} className="text-xs bg-white px-2 py-1 rounded border">
                                        {ing.name}
                                      </span>
                                    ))}
                                  </div>
                                </div>
                              )}
                              
                              {missingCount === 0 && (
                                <div className="bg-green-50 p-3 rounded text-green-700 font-semibold text-center">
                                  ‚úì You have everything to make this recipe!
                                </div>
                              )}

                              <button
                                onClick={() => {
                                  setSelectedRecipe(recipe);
                                  setActiveTab('cookbook');
                                }}
                                className="mt-3 w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                              >
                                View Recipe
                              </button>
                            </div>
                          ))}
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {activeTab === 'nutrition' && (
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Weekly Nutrition Overview</h2>
                    
                    {meals.length === 0 ? (
                      <p className="text-gray-500 text-center py-8">No meals planned yet. Add meals to see nutrition stats!</p>
                    ) : (
                      <div className="space-y-6">
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                          <div className="bg-blue-100 p-6 rounded-lg text-center">
                            <div className="text-3xl font-bold text-blue-600">{nutrition.calories}</div>
                            <div className="text-gray-600">Total Calories</div>
                          </div>
                          <div className="bg-green-100 p-6 rounded-lg text-center">
                            <div className="text-3xl font-bold text-green-600">{nutrition.protein}g</div>
                            <div className="text-gray-600">Protein</div>
                          </div>
                          <div className="bg-yellow-100 p-6 rounded-lg text-center">
                            <div className="text-3xl font-bold text-yellow-600">{nutrition.carbs}g</div>
                            <div className="text-gray-600">Carbs</div>
                          </div>
                          <div className="bg-red-100 p-6 rounded-lg text-center">
                            <div className="text-3xl font-bold text-red-600">{nutrition.fat}g</div>
                            <div className="text-gray-600">Fat</div>
                          </div>
                        </div>

                        <div className="bg-gray-50 p-4 rounded-lg">
                          <h3 className="font-bold mb-3">Daily Average (based on {meals.length} meals)</h3>
                          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div>
                              <div className="font-semibold">{Math.round(nutrition.calories / 7)} cal/day</div>
                              <div className="text-sm text-gray-600">Calories</div>
                            </div>
                            <div>
                              <div className="font-semibold">{Math.round(nutrition.protein / 7)}g/day</div>
                              <div className="text-sm text-gray-600">Protein</div>
                            </div>
                            <div>
                              <div className="font-semibold">{Math.round(nutrition.carbs / 7)}g/day</div>
                              <div className="text-sm text-gray-600">Carbs</div>
                            </div>
                            <div>
                              <div className="font-semibold">{Math.round(nutrition.fat / 7)}g/day</div>
                              <div className="text-sm text-gray-600">Fat</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MealPlannerApp />);
    </script>
</body>
</html>
